import{a as A}from"./chunk-GI3GPFDK.js";import{a as Y}from"./chunk-GC4BMO77.js";import{a as R,c as N,f as W,k as U,l as z,m as q,p as B}from"./chunk-TRMJWQRB.js";import{a as G}from"./chunk-RPCMMASC.js";import{$ as w,A as a,Aa as V,D as _,Da as L,F as M,K as d,P as c,Q as o,R as r,S as O,V as P,W as v,X as p,Y as y,_ as l,ba as x,ca as C,da as b,ea as E,ga as I,ja as T,pa as k,qa as D,r as m,ra as F,s as f,z as S,za as j}from"./chunk-J5HE3GJU.js";var Z=n=>["/pelicula",n];function H(n,t){if(n&1&&(o(0,"option",16),l(1),r()),n&2){let i=t.$implicit;c("value",i),a(),w(i)}}function J(n,t){n&1&&(o(0,"a",17),l(1," Agregar nueva "),r())}function K(n,t){n&1&&(o(0,"div",18)(1,"p"),l(2,"\u{1F3AC} Cargando pel\xEDculas..."),r()())}function Q(n,t){n&1&&(o(0,"div",19)(1,"p"),l(2,"\u274C Error al cargar las pel\xEDculas. Intenta nuevamente m\xE1s tarde."),r()())}function X(n,t){if(n&1&&(o(0,"a",25),O(1,"img",26),r()),n&2){let i=p().$implicit;c("routerLink",I(4,Z,i.id)),a(),c("alt",E(i.titulo))("src",i.imagen,S)}}function $(n,t){if(n&1){let i=P();o(0,"div",27)(1,"button",28),v("click",function(){m(i);let s=p().$implicit,g=p(2);return f(g.editar(s.id))}),l(2,"Editar"),r(),o(3,"button",28),v("click",function(){m(i);let s=p().$implicit,g=p(2);return f(g.eliminar(s.id))}),l(4,"Eliminar"),r()()}}function ee(n,t){if(n&1&&(o(0,"li",22),d(1,X,2,6,"a",23)(2,$,5,0,"div",24),r()),n&2){let i=t.$implicit,e=p(2);a(),c("ngIf",i.imagen),a(),c("ngIf",e.rolUsuario==="admin")}}function te(n,t){if(n&1&&(o(0,"ul",20),d(1,ee,3,2,"li",21),r()),n&2){let i=p();a(),c("ngForOf",i.peliculasFiltradas)}}function ie(n,t){n&1&&(o(0,"p",18),l(1," \u{1F4ED} No hay pel\xEDculas disponibles. "),r())}function ne(n,t){if(n&1&&d(0,ie,2,0,"p",13),n&2){let i=p();c("ngIf",!i.loading&&!i.errorCarga)}}var h=class n{constructor(t,i,e){this.peliculasService=t;this.authService=i;this.router=e}peliculas=[];generos=["Todos"];generoSeleccionado="Todos";criterioOrden="titulo";busqueda="";loading=!0;errorCarga=!1;rolUsuario=null;rolSub;ngOnInit(){this.loading=!0,this.rolSub=this.authService.rol$.subscribe(t=>{t&&(this.rolUsuario=t,this.cargarPeliculas())})}ngOnDestroy(){this.rolSub?.unsubscribe()}cargarPeliculas(){this.peliculasService.getPeliculas().subscribe({next:t=>{this.peliculas=t;let i=new Set(t.map(e=>e.genero?.trim()));this.generos=["Todos",...Array.from(i)],this.loading=!1},error:t=>{console.error("Error al cargar pel\xEDculas:",t),this.errorCarga=!0,this.loading=!1}})}editar(t){this.rolUsuario==="admin"&&t&&this.router.navigate(["/editar",t])}eliminar(t){this.rolUsuario==="admin"&&confirm("\xBFEst\xE1s seguro de eliminar esta pel\xEDcula?")&&this.peliculasService.eliminarPelicula(t).then(()=>console.log("Pel\xEDcula eliminada")).catch(i=>console.error("Error al eliminar:",i))}get peliculasFiltradas(){let t=this.busqueda.toLowerCase(),i=this.peliculas.filter(e=>(this.generoSeleccionado==="Todos"||e.genero===this.generoSeleccionado)&&(e.titulo.toLowerCase().includes(t)||e.genero.toLowerCase().includes(t)||e.director.toLowerCase().includes(t)||e.anio.toString().includes(t)));return this.criterioOrden==="titulo"?i.sort((e,s)=>e.titulo.localeCompare(s.titulo)):this.criterioOrden==="anio"&&i.sort((e,s)=>s.anio-e.anio),i}static \u0275fac=function(i){return new(i||n)(_(G),_(A),_(j))};static \u0275cmp=M({type:n,selectors:[["app-peliculas"]],decls:26,vars:9,consts:[["sinResultados",""],[1,"buscador-centrado"],[1,"buscador-wrapper"],["type","text","placeholder","Buscar por t\xEDtulo, g\xE9nero, director o a\xF1o...",1,"buscador",3,"ngModelChange","ngModel"],[1,"material-icons","icono-lupa"],[1,"filtros-container"],["name","genero",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"ngModelChange","ngModel"],["value","titulo"],["value","anio"],[1,"header"],["routerLink","/agregar","class","btn-agregar",4,"ngIf"],["class","estado-mensaje",4,"ngIf"],["class","estado-mensaje error",4,"ngIf"],["class","lista",4,"ngIf","ngIfElse"],[3,"value"],["routerLink","/agregar",1,"btn-agregar"],[1,"estado-mensaje"],[1,"estado-mensaje","error"],[1,"lista"],["class","tarjeta",4,"ngFor","ngForOf"],[1,"tarjeta"],[3,"routerLink",4,"ngIf"],["class","acciones",4,"ngIf"],[3,"routerLink"],[1,"portada",3,"src","alt"],[1,"acciones"],[3,"click"]],template:function(i,e){if(i&1){let s=P();o(0,"div",1)(1,"div",2)(2,"input",3),b("ngModelChange",function(u){return m(s),C(e.busqueda,u)||(e.busqueda=u),f(u)}),r(),o(3,"span",4),l(4,"search"),r()()(),o(5,"div",5)(6,"label"),l(7," Filtrar por g\xE9nero: "),o(8,"select",6),b("ngModelChange",function(u){return m(s),C(e.generoSeleccionado,u)||(e.generoSeleccionado=u),f(u)}),d(9,H,2,2,"option",7),r()(),o(10,"label"),l(11," Ordenar por: "),o(12,"select",8),b("ngModelChange",function(u){return m(s),C(e.criterioOrden,u)||(e.criterioOrden=u),f(u)}),o(13,"option",9),l(14,"T\xEDtulo (A-Z)"),r(),o(15,"option",10),l(16,"A\xF1o (m\xE1s reciente)"),r()()()(),o(17,"div",11)(18,"h2"),l(19,"Pel\xEDculas"),r(),d(20,J,2,0,"a",12),r(),d(21,K,3,0,"div",13)(22,Q,3,0,"div",14)(23,te,2,1,"ul",15)(24,ne,1,1,"ng-template",null,0,T)}if(i&2){let s=y(25);a(2),x("ngModel",e.busqueda),a(6),x("ngModel",e.generoSeleccionado),a(),c("ngForOf",e.generos),a(3),x("ngModel",e.criterioOrden),a(8),c("ngIf",e.rolUsuario==="admin"),a(),c("ngIf",e.loading),a(),c("ngIf",e.errorCarga&&!e.loading),a(),c("ngIf",!e.loading&&!e.errorCarga&&e.peliculasFiltradas.length>0)("ngIfElse",s)}},dependencies:[F,k,D,B,z,q,R,U,N,W,L,V],styles:[".header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.btn-agregar[_ngcontent-%COMP%]{background:#3498db;color:#fff;padding:10px 16px;text-decoration:none;border-radius:6px;transition:background .3s}.btn-agregar[_ngcontent-%COMP%]:hover{background:#2980b9}.lista[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px}.tarjeta[_ngcontent-%COMP%]{background:#000;color:#fff;border-radius:8px;overflow:hidden;text-align:center;box-shadow:0 2px 6px #0003}.portada[_ngcontent-%COMP%]{width:100%;max-width:300px;height:auto;border-radius:10px;cursor:pointer;transition:transform .2s ease}.portada[_ngcontent-%COMP%]:hover{transform:scale(1.03)}.info[_ngcontent-%COMP%]{padding:15px}.acciones[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center;gap:10px}.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 12px;border:none;border-radius:4px;background:#217243;color:#fff;cursor:pointer}.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{background:#e74c3c}.filtros-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px;margin-top:0;margin-bottom:0;align-items:flex-end}.filtros-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#fff;font-size:14px;display:flex;flex-direction:column;min-width:160px}.filtros-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .filtros-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:6px;border-radius:5px;border:1px solid #444;background-color:#1a1a1a;color:#fff;font-size:14px}.buscador-centrado[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:20px 0}.buscador-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;max-width:450px}.buscador[_ngcontent-%COMP%]{width:100%;padding:12px 20px 12px 0;font-size:18px;border:1px solid #555;border-radius:8px;background-color:#1e1e1e;color:#fff;transition:border .3s,box-shadow .3s;text-align:center}.buscador[_ngcontent-%COMP%]:focus{outline:none;border-color:#00bcd4;box-shadow:0 0 8px #00bcd480}.icono-lupa[_ngcontent-%COMP%]{position:absolute;top:50%;right:14px;transform:translateY(-50%);color:#aaa;font-size:22px;pointer-events:none}.estado-mensaje[_ngcontent-%COMP%]{text-align:center;font-size:18px;color:#ccc;margin:40px 0}.estado-mensaje.error[_ngcontent-%COMP%]{color:#ff4c4c}"]})};var Ce=[{path:"",component:h,canActivate:[Y]}];export{Ce as routes};
