import{Ga as d,Ia as p,Ka as g,La as j,Ma as b,Na as v,Ua as n,Va as l,Xa as w,d as u,f as h,m as f,p as a,za as m}from"./chunk-J5HE3GJU.js";var S=class c{constructor(s,e,r){this.auth=s;this.router=e;this.firestore=r;g(this.auth,t=>u(this,null,function*(){if(this.user=t,t){let i=n(this.firestore,`usuarios/${t.uid}`),o=yield l(i),x=o.exists()?o.data().rol:null;this.rolSubject.next(x)}else this.rolSubject.next(null)}))}user=null;rolSubject=new h(null);rol$=this.rolSubject.asObservable();getUser(){return this.user}getRol(){return this.rolSubject.value}logout(){return b(this.auth).then(()=>{this.router.navigate(["/login"])})}registrar(s,e,r="usuario"){return u(this,null,function*(){let t=yield p(this.auth,s,e),i=n(this.firestore,`usuarios/${t.user.uid}`);return yield w(i,{uid:t.user.uid,email:t.user.email,rol:r}),this.user=t.user,this.rolSubject.next(r),t})}login(s,e){return u(this,null,function*(){let r=yield j(this.auth,s,e);this.user=r.user;let t=n(this.firestore,`usuarios/${r.user.uid}`),i=yield l(t),o=i.exists()?i.data().rol:null;return this.rolSubject.next(o),r})}static \u0275fac=function(e){return new(e||c)(a(d),a(m),a(v))};static \u0275prov=f({token:c,factory:c.\u0275fac,providedIn:"root"})};export{S as a};
