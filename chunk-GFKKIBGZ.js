import{a as V}from"./chunk-VRVQKTDE.js";import{a as w,b as c,c as D,d as R,g as k,h as z,i as q,j as G,o as j,q as H}from"./chunk-TRMJWQRB.js";import{a as L}from"./chunk-RPCMMASC.js";import{A as p,D as g,Da as N,F as S,K as s,P as l,Q as i,R as n,S as d,W as h,X as E,_ as a,d as C,h as v,m as y,p as P,qa as I,ra as F,ua as T,wa as A,z as M,za as O}from"./chunk-J5HE3GJU.js";var x=class t{constructor(r){this.http=r}cloudName="dbezo9ehh";uploadPreset="Imagenes";subirImagen(r){return C(this,null,function*(){let o=`https://api.cloudinary.com/v1_1/${this.cloudName}/image/upload`,e=new FormData;return e.append("file",r),e.append("upload_preset",this.uploadPreset),(yield v(this.http.post(o,e))).secure_url})}static \u0275fac=function(o){return new(o||t)(P(T))};static \u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})};function B(t,r){t&1&&(i(0,"div",11),a(1,` Pel\xEDcula guardada con \xE9xito
`),n())}function $(t,r){t&1&&(i(0,"span"),a(1," El t\xEDtulo es requerido. "),n())}function J(t,r){t&1&&(i(0,"span"),a(1," El g\xE9nero es requerido. "),n())}function K(t,r){t&1&&(i(0,"span"),a(1," A\xF1o inv\xE1lido. Debe ser mayor a 1900. "),n())}function Q(t,r){t&1&&(i(0,"span"),a(1," El director es requerido. "),n())}function W(t,r){if(t&1&&d(0,"img",12),t&2){let o=E();l("src",o.imagenURL,M)}}var b=class t{constructor(r,o,e,m){this.fb=r;this.peliculasService=o;this.cloudinary=e;this.router=m;this.formulario=this.fb.group({titulo:["",c.required],genero:["",c.required],anio:[new Date().getFullYear(),[c.required,c.min(1900)]],director:["",c.required],imagen:["",c.required],descripcion:[""]})}formulario;errorMsg="";mostrarToast=!1;imagenURL="";onFileSelected(r){let o=r.target.files[0];o&&this.cloudinary.subirImagen(o).then(e=>{this.imagenURL=e,this.formulario.patchValue({imagen:e})}).catch(e=>{this.errorMsg="Error al subir imagen",console.error(e)})}guardar(){this.formulario.valid?this.peliculasService.agregarPelicula(this.formulario.value).then(()=>{this.mostrarToast=!0,setTimeout(()=>{this.mostrarToast=!1,this.router.navigate(["/peliculas"])},2e3)}).catch(r=>{this.errorMsg="Error al guardar: "+r.message,setTimeout(()=>this.errorMsg="",4e3)}):(this.errorMsg="Completa todos los campos requeridos",setTimeout(()=>this.errorMsg="",3e3))}autoResize(r){let o=r.target;o.style.height="auto",o.style.height=`${o.scrollHeight}px`}static \u0275fac=function(o){return new(o||t)(g(j),g(L),g(x),g(O))};static \u0275cmp=S({type:t,selectors:[["app-agregar-pelicula"]],decls:27,vars:8,consts:[["class","toast",4,"ngIf"],[1,"formulario-pelicula",3,"ngSubmit","formGroup"],["formControlName","titulo"],[4,"ngIf"],["formControlName","genero"],["type","number","formControlName","anio"],["formControlName","director"],["formControlName","descripcion","rows","3","placeholder","Descripci\xF3n opcional...",3,"input"],["type","file",3,"change"],["width","150",3,"src",4,"ngIf"],["type","submit",3,"disabled"],[1,"toast"],["width","150",3,"src"]],template:function(o,e){if(o&1&&(s(0,B,2,0,"div",0),i(1,"form",1),h("ngSubmit",function(){return e.guardar()}),i(2,"label"),a(3," T\xEDtulo: "),d(4,"input",2),s(5,$,2,0,"span",3),n(),i(6,"label"),a(7," G\xE9nero: "),d(8,"input",4),s(9,J,2,0,"span",3),n(),i(10,"label"),a(11," A\xF1o: "),d(12,"input",5),s(13,K,2,0,"span",3),n(),i(14,"label"),a(15," Director: "),d(16,"input",6),s(17,Q,2,0,"span",3),n(),i(18,"label"),a(19," Descripci\xF3n: "),i(20,"textarea",7),h("input",function(u){return e.autoResize(u)}),n()(),i(21,"label"),a(22," Imagen: "),i(23,"input",8),h("change",function(u){return e.onFileSelected(u)}),n()(),s(24,W,1,1,"img",9),i(25,"button",10),a(26,"Guardar"),n()()),o&2){let m,u,f,_;l("ngIf",e.mostrarToast),p(),l("formGroup",e.formulario),p(4),l("ngIf",((m=e.formulario.get("titulo"))==null?null:m.invalid)&&((m=e.formulario.get("titulo"))==null?null:m.touched)),p(4),l("ngIf",((u=e.formulario.get("genero"))==null?null:u.invalid)&&((u=e.formulario.get("genero"))==null?null:u.touched)),p(4),l("ngIf",((f=e.formulario.get("anio"))==null?null:f.invalid)&&((f=e.formulario.get("anio"))==null?null:f.touched)),p(4),l("ngIf",((_=e.formulario.get("director"))==null?null:_.invalid)&&((_=e.formulario.get("director"))==null?null:_.touched)),p(7),l("ngIf",e.imagenURL),p(),l("disabled",e.formulario.invalid)}},dependencies:[F,I,H,k,w,z,D,R,q,G,N,A],styles:[".formulario-pelicula[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px;max-width:600px;margin:30px auto;padding:25px;background-color:#1a1a1a;border-radius:10px;box-shadow:0 0 10px #ffffff1a;color:#fff}label[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-weight:700;color:#fff}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{margin-top:5px;padding:10px;font-size:16px;border-radius:6px;border:1px solid #444;background-color:#2a2a2a;color:#fff;resize:vertical}textarea[_ngcontent-%COMP%]{min-height:80px;line-height:1.5}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3498db;box-shadow:0 0 5px #3498db80}span[_ngcontent-%COMP%]{font-size:.85em;color:#e74c3c;margin-top:5px}button[_ngcontent-%COMP%]{margin-top:10px;padding:12px;background-color:#27ae60;border:none;border-radius:6px;color:#fff;font-size:16px;font-weight:700;cursor:pointer;transition:background-color .3s}button[_ngcontent-%COMP%]:hover{background-color:#219150}button[disabled][_ngcontent-%COMP%]{background-color:#555;cursor:not-allowed}.toast[_ngcontent-%COMP%]{position:fixed;bottom:30px;right:30px;background-color:#4caf50;color:#fff;padding:16px 24px;border-radius:8px;box-shadow:0 2px 10px #0000004d;font-size:16px;z-index:9999;animation:_ngcontent-%COMP%_fadein .5s,_ngcontent-%COMP%_fadeout .5s 1.5s}@keyframes _ngcontent-%COMP%_fadein{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeout{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(10px)}}"]})};var _e=[{path:"",component:b,canActivate:[V("admin")]}];export{_e as routes};
